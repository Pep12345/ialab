import subprocess
import pandas as pd
from xlsxwriter import Workbook
import numpy as np


#Tramite la libreria "subprocess" riusciamo ad eseguire il programma "./calendario_master.cl" come se fossimo su un terminale
#ottenendo solo la soluzione salvandola nella variabile 'all_solution'
asp_name = "./calendario_master.cl"
command = "clingo --verbose=0 --warn=no-global-variable "+asp_name
res = subprocess.Popen(command, shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, close_fds=True)
solution = res.communicate()[0].strip()
return_code = res.returncode
solution = solution.decode("utf-8").replace("\nSATISFIABLE", "")

all_solutions = solution.split("\n")
print(all_solutions)


#all_solution = ['lezione(1,venerdi,8,presentazione_master) lezione(1,venerdi,9,presentazione_master) lezione(1,venerdi,8,project_Management) lezione(1,venerdi,9,project_Management) lezione(1,venerdi,10,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(1,venerdi,11,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(1,venerdi,12,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(1,venerdi,14,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(1,venerdi,15,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(1,venerdi,16,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(2,venerdi,8,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(2,venerdi,9,tecnologie_server_side_per_il_web) lezione(2,venerdi,10,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(2,venerdi,11,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(2,venerdi,12,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(2,venerdi,14,elementi_di_fotografia_digitale) lezione(2,venerdi,15,tecnologie_server_side_per_il_web) lezione(2,venerdi,16,elementi_di_fotografia_digitale) lezione(3,venerdi,8,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(3,venerdi,9,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(3,venerdi,10,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(3,venerdi,11,tecnologie_server_side_per_il_web) lezione(3,venerdi,12,tecnologie_server_side_per_il_web) lezione(3,venerdi,14,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(3,venerdi,15,tecnologie_server_side_per_il_web) lezione(3,venerdi,16,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(4,venerdi,8,project_Management) lezione(4,venerdi,9,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(4,venerdi,10,project_Management) lezione(4,venerdi,11,project_Management) lezione(4,venerdi,12,grafica_3D) lezione(4,venerdi,14,grafica_3D) lezione(4,venerdi,15,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(4,venerdi,16,project_Management) lezione(5,venerdi,8,tecniche_e_strumenti_di_Marketing_digitale) lezione(5,venerdi,9,tecnologie_server_side_per_il_web) lezione(5,venerdi,10,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(5,venerdi,11,tecniche_e_strumenti_di_Marketing_digitale) lezione(5,venerdi,12,tecnologie_server_side_per_il_web) lezione(5,venerdi,14,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(5,venerdi,15,project_Management) lezione(5,venerdi,16,project_Management) lezione(6,venerdi,8,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(6,venerdi,9,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(6,venerdi,10,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(6,venerdi,11,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(6,venerdi,12,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(6,venerdi,14,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(6,venerdi,15,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(6,venerdi,16,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(7,venerdi,8,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(7,venerdi,9,grafica_3D) lezione(7,venerdi,10,linguaggi_di_markup) lezione(7,venerdi,11,grafica_3D) lezione(7,venerdi,12,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(7,venerdi,14,linguaggi_di_markup) lezione(7,venerdi,15,grafica_3D) lezione(7,venerdi,16,grafica_3D) lezione(8,venerdi,8,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(8,venerdi,9,tecnologie_server_side_per_il_web) lezione(8,venerdi,10,progettazione_grafica_e_design_di_interfacce) lezione(8,venerdi,11,progettazione_grafica_e_design_di_interfacce) lezione(8,venerdi,12,grafica_3D) lezione(8,venerdi,14,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(8,venerdi,15,tecnologie_server_side_per_il_web) lezione(8,venerdi,16,grafica_3D) lezione(9,venerdi,8,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(9,venerdi,9,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(9,venerdi,10,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(9,venerdi,11,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(9,venerdi,12,tecniche_e_strumenti_di_Marketing_digitale) lezione(9,venerdi,14,tecniche_e_strumenti_di_Marketing_digitale) lezione(9,venerdi,15,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(9,venerdi,16,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(10,venerdi,8,marketing_digitale) lezione(10,venerdi,9,marketing_digitale) lezione(10,venerdi,10,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(10,venerdi,11,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(10,venerdi,12,elementi_di_fotografia_digitale) lezione(10,venerdi,14,elementi_di_fotografia_digitale) lezione(10,venerdi,15,tecniche_e_strumenti_di_Marketing_digitale) lezione(10,venerdi,16,tecniche_e_strumenti_di_Marketing_digitale) lezione(11,venerdi,8,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(11,venerdi,9,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(11,venerdi,10,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(11,venerdi,11,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(11,venerdi,12,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(11,venerdi,14,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(11,venerdi,15,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(11,venerdi,16,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(12,venerdi,8,progettazione_grafica_e_design_di_interfacce) lezione(12,venerdi,9,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(12,venerdi,10,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(12,venerdi,11,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(12,venerdi,12,progettazione_grafica_e_design_di_interfacce) lezione(12,venerdi,14,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(12,venerdi,15,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(12,venerdi,16,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(13,venerdi,8,linguaggi_di_markup) lezione(13,venerdi,9,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(13,venerdi,10,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(13,venerdi,11,linguaggi_di_markup) lezione(13,venerdi,12,linguaggi_di_markup) lezione(13,venerdi,14,grafica_3D) lezione(13,venerdi,15,linguaggi_di_markup) lezione(13,venerdi,16,grafica_3D) lezione(14,venerdi,8,semiologia_e_multimedialita) lezione(14,venerdi,9,progettazione_di_basi_di_dati) lezione(14,venerdi,10,semiologia_e_multimedialita) lezione(14,venerdi,11,progettazione_di_basi_di_dati) lezione(14,venerdi,12,progettazione_di_basi_di_dati) lezione(14,venerdi,14,tecnologie_server_side_per_il_web) lezione(14,venerdi,15,tecnologie_server_side_per_il_web) lezione(14,venerdi,16,semiologia_e_multimedialita) lezione(15,venerdi,8,elementi_di_fotografia_digitale) lezione(15,venerdi,9,elementi_di_fotografia_digitale) lezione(15,venerdi,10,linguaggi_di_markup) lezione(15,venerdi,11,linguaggi_di_markup) lezione(15,venerdi,12,elementi_di_fotografia_digitale) lezione(15,venerdi,14,linguaggi_di_markup) lezione(15,venerdi,15,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(15,venerdi,16,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(16,venerdi,8,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(16,venerdi,9,linguaggi_di_markup) lezione(16,venerdi,10,progettazione_di_basi_di_dati) lezione(16,venerdi,11,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(16,venerdi,12,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(16,venerdi,14,progettazione_di_basi_di_dati) lezione(16,venerdi,15,progettazione_di_basi_di_dati) lezione(16,venerdi,16,linguaggi_di_markup) lezione(17,venerdi,8,progettazione_grafica_e_design_di_interfacce) lezione(17,venerdi,9,progettazione_grafica_e_design_di_interfacce) lezione(17,venerdi,10,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(17,venerdi,11,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(17,venerdi,12,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(17,venerdi,14,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(17,venerdi,15,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(17,venerdi,16,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(18,venerdi,8,linguaggi_di_markup) lezione(18,venerdi,9,linguaggi_di_markup) lezione(18,venerdi,10,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(18,venerdi,11,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(18,venerdi,12,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(18,venerdi,14,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(18,venerdi,15,linguaggi_di_markup) lezione(18,venerdi,16,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(19,venerdi,8,progettazione_di_basi_di_dati) lezione(19,venerdi,9,introduzione_al_social_media_management) lezione(19,venerdi,10,introduzione_al_social_media_management) lezione(19,venerdi,11,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(19,venerdi,12,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(19,venerdi,14,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(19,venerdi,15,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(19,venerdi,16,progettazione_di_basi_di_dati) lezione(20,venerdi,8,progettazione_di_basi_di_dati) lezione(20,venerdi,9,progettazione_di_basi_di_dati) lezione(20,venerdi,10,crossmedia_articolazione_delle_scritture_multimediali) lezione(20,venerdi,11,crossmedia_articolazione_delle_scritture_multimediali) lezione(20,venerdi,12,acquisizione_ed_elaborazione_del_suono) lezione(20,venerdi,14,acquisizione_ed_elaborazione_del_suono) lezione(20,venerdi,15,crossmedia_articolazione_delle_scritture_multimediali) lezione(20,venerdi,16,crossmedia_articolazione_delle_scritture_multimediali) lezione(21,venerdi,8,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(21,venerdi,9,la_gestione_della_qualita) lezione(21,venerdi,10,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(21,venerdi,11,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(21,venerdi,12,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(21,venerdi,14,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(21,venerdi,15,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(21,venerdi,16,la_gestione_della_qualita) lezione(22,venerdi,8,crossmedia_articolazione_delle_scritture_multimediali) lezione(22,venerdi,9,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(22,venerdi,10,crossmedia_articolazione_delle_scritture_multimediali) lezione(22,venerdi,11,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(22,venerdi,12,crossmedia_articolazione_delle_scritture_multimediali) lezione(22,venerdi,14,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(22,venerdi,15,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(22,venerdi,16,crossmedia_articolazione_delle_scritture_multimediali) lezione(23,venerdi,8,crossmedia_articolazione_delle_scritture_multimediali) lezione(23,venerdi,9,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(23,venerdi,10,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(23,venerdi,11,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(23,venerdi,12,crossmedia_articolazione_delle_scritture_multimediali) lezione(23,venerdi,14,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(23,venerdi,15,la_gestione_delle_risorse_umane) lezione(23,venerdi,16,la_gestione_delle_risorse_umane) lezione(24,venerdi,8,introduzione_al_social_media_management) lezione(24,venerdi,9,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(24,venerdi,10,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(24,venerdi,11,acquisizione_ed_elaborazione_del_suono) lezione(24,venerdi,12,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(24,venerdi,14,introduzione_al_social_media_management) lezione(24,venerdi,15,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(24,venerdi,16,acquisizione_ed_elaborazione_del_suono) lezione(7,lunedi,8,marketing_digitale) lezione(7,lunedi,9,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(7,lunedi,10,acquisizione_ed_elaborazione_del_suono) lezione(7,lunedi,11,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(7,lunedi,12,marketing_digitale) lezione(7,lunedi,14,marketing_digitale) lezione(7,lunedi,15,marketing_digitale) lezione(7,lunedi,16,acquisizione_ed_elaborazione_del_suono) lezione(7,martedi,8,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(7,martedi,9,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(7,martedi,10,marketing_digitale) lezione(7,martedi,11,marketing_digitale) lezione(7,martedi,12,semiologia_e_multimedialita) lezione(7,martedi,14,semiologia_e_multimedialita) lezione(7,martedi,15,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(7,martedi,16,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(7,mercoledi,8,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(7,mercoledi,9,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(7,mercoledi,10,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(7,mercoledi,11,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(7,mercoledi,12,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(7,mercoledi,14,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(7,mercoledi,15,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(7,mercoledi,16,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(7,giovedi,8,elementi_di_fotografia_digitale) lezione(7,giovedi,9,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(7,giovedi,10,progettazione_di_basi_di_dati) lezione(7,giovedi,11,progettazione_di_basi_di_dati) lezione(7,giovedi,12,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(7,giovedi,14,elementi_di_fotografia_digitale) lezione(7,giovedi,15,elementi_di_fotografia_digitale) lezione(7,giovedi,16,acquisizione_ed_elaborazione_di_immagini_statiche_grafica) lezione(16,lunedi,8,progettazione_grafica_e_design_di_interfacce) lezione(16,lunedi,9,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(16,lunedi,10,semiologia_e_multimedialita) lezione(16,lunedi,11,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_I) lezione(16,lunedi,12,semiologia_e_multimedialita) lezione(16,lunedi,14,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(16,lunedi,15,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(16,lunedi,16,progettazione_grafica_e_design_di_interfacce) lezione(16,martedi,8,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(16,martedi,9,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(16,martedi,10,crossmedia_articolazione_delle_scritture_multimediali) lezione(16,martedi,11,la_gestione_della_qualita) lezione(16,martedi,12,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(16,martedi,14,la_gestione_della_qualita) lezione(16,martedi,15,comunicazione_pubblicitaria_e_comunicazione_pubblica) lezione(16,martedi,16,crossmedia_articolazione_delle_scritture_multimediali) lezione(16,mercoledi,8,linguaggi_di_markup) lezione(16,mercoledi,9,crossmedia_articolazione_delle_scritture_multimediali) lezione(16,mercoledi,10,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(16,mercoledi,11,la_gestione_della_qualita) lezione(16,mercoledi,12,la_gestione_della_qualita) lezione(16,mercoledi,14,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(16,mercoledi,15,linguaggi_di_markup) lezione(16,mercoledi,16,crossmedia_articolazione_delle_scritture_multimediali) lezione(16,giovedi,8,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(16,giovedi,9,acquisizione_ed_elaborazione_del_suono) lezione(16,giovedi,10,introduzione_al_social_media_management) lezione(16,giovedi,11,introduzione_al_social_media_management) lezione(16,giovedi,12,grafica_3D) lezione(16,giovedi,14,acquisizione_ed_elaborazione_del_suono) lezione(16,giovedi,15,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(16,giovedi,16,grafica_3D) lezione(1,sabato,8,progettazione_di_basi_di_dati) lezione(1,sabato,9,progettazione_di_basi_di_dati) lezione(1,sabato,10,project_Management) lezione(1,sabato,14,project_Management) lezione(2,sabato,8,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(2,sabato,11,progettazione_di_basi_di_dati) lezione(2,sabato,12,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(2,sabato,15,progettazione_di_basi_di_dati) lezione(2,sabato,16,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(3,sabato,8,linguaggi_di_markup) lezione(3,sabato,10,grafica_3D) lezione(3,sabato,12,linguaggi_di_markup) lezione(3,sabato,16,grafica_3D) lezione(4,sabato,9,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(4,sabato,10,project_Management) lezione(4,sabato,14,project_Management) lezione(4,sabato,15,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(5,sabato,10,tecnologie_server_side_per_il_web) lezione(5,sabato,12,progettazione_grafica_e_design_di_interfacce) lezione(5,sabato,14,tecnologie_server_side_per_il_web) lezione(5,sabato,16,progettazione_grafica_e_design_di_interfacce) lezione(6,sabato,8,project_Management) lezione(6,sabato,9,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(6,sabato,11,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(6,sabato,12,project_Management) lezione(7,sabato,11,marketing_digitale) lezione(7,sabato,12,tecnologie_server_side_per_il_web) lezione(7,sabato,14,tecnologie_server_side_per_il_web) lezione(7,sabato,15,tecnologie_server_side_per_il_web) lezione(7,sabato,16,marketing_digitale) lezione(8,sabato,10,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(8,sabato,11,la_gestione_delle_risorse_umane) lezione(8,sabato,14,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(8,sabato,15,la_gestione_delle_risorse_umane) lezione(8,sabato,16,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(9,sabato,10,la_gestione_della_qualita) lezione(9,sabato,11,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(9,sabato,12,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(9,sabato,14,progettazione_e_sviluppo_di_applicazioni_web_su_dispositivi_mobile_II) lezione(9,sabato,16,la_gestione_della_qualita) lezione(10,sabato,9,tecniche_e_strumenti_di_Marketing_digitale) lezione(10,sabato,11,tecniche_e_strumenti_di_Marketing_digitale) lezione(10,sabato,12,tecnologie_server_side_per_il_web) lezione(10,sabato,15,tecnologie_server_side_per_il_web) lezione(11,sabato,8,progettazione_di_basi_di_dati) lezione(11,sabato,9,progettazione_di_basi_di_dati) lezione(11,sabato,11,grafica_3D) lezione(11,sabato,14,grafica_3D) lezione(12,sabato,8,la_gestione_delle_risorse_umane) lezione(12,sabato,9,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(12,sabato,10,la_gestione_delle_risorse_umane) lezione(12,sabato,11,i_vincoli_giuridici_del_progetto_diritto_dei_media) lezione(13,sabato,9,linguaggi_di_markup) lezione(13,sabato,10,tecnologie_server_side_per_il_web) lezione(13,sabato,11,tecnologie_server_side_per_il_web) lezione(13,sabato,16,linguaggi_di_markup) lezione(14,sabato,10,tecniche_e_strumenti_di_Marketing_digitale) lezione(14,sabato,11,la_gestione_delle_risorse_umane) lezione(14,sabato,12,la_gestione_delle_risorse_umane) lezione(14,sabato,14,tecniche_e_strumenti_di_Marketing_digitale) lezione(15,sabato,8,semiologia_e_multimedialita) lezione(15,sabato,9,progettazione_di_basi_di_dati) lezione(15,sabato,11,semiologia_e_multimedialita) lezione(15,sabato,15,semiologia_e_multimedialita) lezione(15,sabato,16,progettazione_di_basi_di_dati) lezione(16,sabato,8,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(16,sabato,11,strumenti_e_metodi_di_interazione_nei_Social_media) lezione(16,sabato,12,acquisizione_ed_elaborazione_del_suono) lezione(16,sabato,16,acquisizione_ed_elaborazione_del_suono) lezione(17,sabato,8,crossmedia_articolazione_delle_scritture_multimediali) lezione(17,sabato,9,crossmedia_articolazione_delle_scritture_multimediali) lezione(17,sabato,11,grafica_3D) lezione(17,sabato,14,grafica_3D) lezione(18,sabato,8,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(18,sabato,9,ambienti_di_sviluppo_e_linguaggi_client_side_per_il_web) lezione(18,sabato,15,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(18,sabato,16,accessibilita_e_usabilita_nella_progettazione_multimediale) lezione(19,sabato,8,introduzione_al_social_media_management) lezione(19,sabato,11,introduzione_al_social_media_management) lezione(19,sabato,14,introduzione_al_social_media_management) lezione(19,sabato,16,introduzione_al_social_media_management) lezione(20,sabato,9,introduzione_al_social_media_management) lezione(20,sabato,10,introduzione_al_social_media_management) lezione(20,sabato,11,crossmedia_articolazione_delle_scritture_multimediali) lezione(20,sabato,14,crossmedia_articolazione_delle_scritture_multimediali) lezione(21,sabato,9,grafica_3D) lezione(21,sabato,14,grafica_3D) lezione(21,sabato,15,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(21,sabato,16,risorse_digitali_per_il_progetto_collaborazione_e_documentazione) lezione(22,sabato,9,crossmedia_articolazione_delle_scritture_multimediali) lezione(22,sabato,12,la_gestione_della_qualita) lezione(22,sabato,14,crossmedia_articolazione_delle_scritture_multimediali) lezione(22,sabato,16,la_gestione_della_qualita) lezione(23,sabato,8,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(23,sabato,9,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(23,sabato,11,introduzione_al_social_media_management) lezione(23,sabato,12,fondamenti_di_ICT_e_Paradigmi_di_Programmazione) lezione(23,sabato,15,introduzione_al_social_media_management) lezione(24,sabato,8,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(24,sabato,11,la_gestione_delle_risorse_umane) lezione(24,sabato,14,acquisizione_ed_elaborazione_di_sequenze_di_immagini_digitali) lezione(24,sabato,15,la_gestione_delle_risorse_umane) lezione(19,sabato,14,recupero) lezione(19,sabato,15,recupero) lezione(21,sabato,10,recupero) lezione(21,sabato,11,recupero)\r']
#Preprocessing della struttra dati uscente dall'esecuzione di clingo
all_solution = all_solutions[0].replace("\r","").replace('lezione(','').replace(')','').split(" ")


#Riferimento al file excel che verrà creato
file = pd.ExcelWriter("orario.xlsx", engine="xlsxwriter")
#Creazione del dataFrame andando a definire righe e colonne. Le righe sono inizializzate in base al totale dei valori,
#anche se successivamente verranno splittati per settimana nei vari fogli
df = pd.DataFrame(index=range(len(all_solution)), columns=['settimana', 'giorno', 'inizio', 'corso'])

#Si aggiunge al dataframe 'df' tutti i dati utilizzando come indice (index) di riferimento, il numero  precedentemnte dichiarato
# index=range(len(all_solution)) difatti il for ciclerà n volte dato n=range(len(all_solution))
for i, solution in enumerate(all_solution):
        row = solution.split(',')
        df.loc[i] = row

#Data la colonna settimana "def['Settiman'] con .unique andiam a stampare le varie occorrenze del valore (uno per tipo)
#  printi(df['settmana'].unique())

#Seleziona la colonna settimana stampandone il numero di righe e dtype
#  print(df['settimana'])

#Permette di raggruppare in dataframe tutti i dati relativi alla settimana 'df['Settimana'].unique()[0]' (settimana 1)
#NOTA BENE se si inserisce direttamente il numero al posto di 'df['Settimana'].unique()[0]' non funziona
#  print(df[df['settimana'] == df['settimana'].unique()[0]])

#Raggruppa in vari dataframe (non salvati nell'esempio) le lezione "raggruppate" per n_set
# (es. primo dataframe tutte quelle della prima settimana, fino all'ultimo dataframe tutte quelle dell'ultima settimana)
#for n_set in df['settimana'].unique():
#       riferimento alla columns giorno
#        print(df.giorno)
#       Stampa del dataframe di indice uguale a n_set (n_set = giorno della settimana)
#        print(df[df['settimana'] == n_set])


for n_set in df['settimana'].unique():
        # Create a new column as type 'category' and Reorder the categories and add the missing categories
        # https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.astype.html
        # https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cat.set_categories.html
        df.giorno = df.giorno.astype('category').cat.set_categories(['sabato', 'venerdi', 'giovedi', 'mercoledi', 'martedi', 'lunedi'])
        df.inizio = df.inizio.astype('category').cat.set_categories(['16', '15', '14', '12', '11', '10', '9', '8'])
        df[df['settimana'] == n_set].sort_values(by=['giorno', 'inizio'], ascending=False).to_excel(file, sheet_name=n_set,index= False)


file.save()
